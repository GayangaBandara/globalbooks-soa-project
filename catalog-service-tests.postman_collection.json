{
  "info": {
    "name": "GlobalBooks CatalogService SOAP API Tests",
    "description": "Postman collection for testing CatalogService SOAP API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Get Book by ISBN",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response is valid SOAP\", function () {",
              "    var responseXml = xml2Json(responseBody);",
              "    pm.expect(responseXml).to.have.property('Envelope');",
              "    pm.expect(responseXml.Envelope).to.have.property('Body');",
              "});",
              "",
              "pm.test(\"Book details are present\", function () {",
              "    var responseXml = xml2Json(responseBody);",
              "    var response = responseXml.Envelope.Body.getBookResponse;",
              "    pm.expect(response).to.have.property('title');",
              "    pm.expect(response).to.have.property('author');",
              "    pm.expect(response).to.have.property('price');",
              "});"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "text/xml"
          },
          {
            "key": "SOAPAction",
            "value": "\"\""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:cat=\"http://catalog.globalbooks.com/\">\n   <soapenv:Header/>\n   <soapenv:Body>\n      <cat:getBookRequest>\n         <isbn>978-0134685991</isbn>\n      </cat:getBookRequest>\n   </soapenv:Body>\n</soapenv:Envelope>"
        },
        "url": {
          "raw": "http://localhost:8080/catalog-service/catalog",
          "protocol": "http",
          "host": ["localhost"],
          "port": "8080",
          "path": ["catalog-service", "catalog"]
        }
      },
      "response": []
    },
    {
      "name": "Get Non-existent Book",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 500 for non-existent book\", function () {",
              "    pm.response.to.have.status(500);",
              "});",
              "",
              "pm.test(\"Response contains SOAP Fault\", function () {",
              "    var responseXml = xml2Json(responseBody);",
              "    pm.expect(responseXml.Envelope.Body).to.have.property('Fault');",
              "});"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "text/xml"
          },
          {
            "key": "SOAPAction",
            "value": "\"\""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:cat=\"http://catalog.globalbooks.com/\">\n   <soapenv:Header/>\n   <soapenv:Body>\n      <cat:getBookRequest>\n         <isbn>non-existent-isbn</isbn>\n      </cat:getBookRequest>\n   </soapenv:Body>\n</soapenv:Envelope>"
        },
        "url": {
          "raw": "http://localhost:8080/catalog-service/catalog",
          "protocol": "http",
          "host": ["localhost"],
          "port": "8080",
          "path": ["catalog-service", "catalog"]
        }
      },
      "response": []
    },
    {
      "name": "Get WSDL",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response is valid WSDL\", function () {",
              "    pm.expect(responseBody).to.include('<?xml version=\"1.0\"');",
              "    pm.expect(responseBody).to.include('<definitions');",
              "    pm.expect(responseBody).to.include('targetNamespace=\"http://catalog.globalbooks.com/\"');",
              "});"
            ]
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "http://localhost:8080/catalog-service/catalog?wsdl",
          "protocol": "http",
          "host": ["localhost"],
          "port": "8080",
          "path": ["catalog-service", "catalog"],
          "query": [
            {
              "key": "wsdl",
              "value": null
            }
          ]
        }
      },
      "response": []
    }
  ]
}
